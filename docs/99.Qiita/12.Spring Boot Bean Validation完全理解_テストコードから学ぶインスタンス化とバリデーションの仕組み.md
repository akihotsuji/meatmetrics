# Spring Boot Bean Validation å®Œå…¨ç†è§£ï¼šãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‹ã‚‰å­¦ã¶ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ä»•çµ„ã¿

## ã¯ã˜ã‚ã«

Spring Boot ã§ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã„ã¦ã€ãµã¨ç–‘å•ã«æ€ã£ãŸã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ

```java
@Test
void validCommand_shouldPassValidation() {
    ChangePasswordCommand cmd = new ChangePasswordCommand("CurrentPass123", "NewPass456");
    Set<ConstraintViolation<ChangePasswordCommand>> violations = validator.validate(cmd);
    assertThat(violations).isEmpty();
}
```

ã“ã®`validator.validate(cmd)`ã£ã¦ä¸€ä½“ä½•ã‚’ã—ã¦ã„ã‚‹ã®ï¼ŸğŸ¤”

ãã—ã¦ã€ã‚‚ã£ã¨ç–‘å•ãªã®ãŒ...

```java
ChangePasswordCommand cmd = new ChangePasswordCommand(null, "çŸ­ã„"); // è¤‡æ•°ã‚¨ãƒ©ãƒ¼
```

**ã€Œãˆã€ã“ã‚Œã£ã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ãŸæ™‚ç‚¹ã§ä¾‹å¤–ãŒæŠ•ã’ã‚‰ã‚Œã‚‹ã‚“ã˜ã‚ƒãªã„ã®ï¼Ÿã€**

å®Ÿã¯ã“ã“ã«ã€Spring Boot ã® Bean Validation ã¨ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå¤‰æ›ã®å¥¥æ·±ã„ä»•çµ„ã¿ãŒéš ã•ã‚Œã¦ã„ã‚‹ã‚“ã§ã™ã€‚

ä»Šå›ã¯ã€ãã‚“ãªç–‘å•ã‹ã‚‰å§‹ã¾ã£ã¦åˆ†ã‹ã£ãŸã€ŒSpring Boot ã®è‡ªå‹•å¤‰æ›ï¼†ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€ã®ä»•çµ„ã¿ã‚’ã€åˆ†ã‹ã‚Šã‚„ã™ãè§£èª¬ã—ã¦ã¿ã¾ã™ï¼

## ğŸ” ã¾ãšã¯åŸºæœ¬ï¼šBean Validation ã£ã¦ä½•ã—ã¦ã‚‹ã®ï¼Ÿ

### ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã§ã¯ä¾‹å¤–ã¯æŠ•ã’ã‚‰ã‚Œãªã„ï¼

å¤šãã®äººãŒå‹˜é•ã„ã—ãŒã¡ãªãƒã‚¤ãƒ³ãƒˆãŒã“ã“ã§ã™ï¼š

```java
// ã“ã‚Œã¯æ™®é€šã«æˆåŠŸã™ã‚‹ï¼ˆä¾‹å¤–ãªã—ï¼‰
ChangePasswordCommand cmd = new ChangePasswordCommand(null, "çŸ­ã„");
System.out.println("ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–å®Œäº†ï¼"); // ã“ã®è¡Œã¯å®Ÿè¡Œã•ã‚Œã‚‹

// ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ˜ç¤ºçš„ã«å®Ÿè¡Œã—ãŸã¨ãã®ã¿å‹•ä½œ
Set<ConstraintViolation<ChangePasswordCommand>> violations = validator.validate(cmd);
// â†‘ ã“ã“ã§åˆã‚ã¦ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã€é•åãŒæ¤œå‡ºã•ã‚Œã‚‹
```

### ãªãœã“ã®è¨­è¨ˆãªã®ã‹ï¼Ÿ

Bean Validation ãŒã€Œå®£è¨€çš„ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€ã ã‹ã‚‰ã§ã™ï¼š

1. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: æ¯å›ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ°ã‚‹ã¨é‡ã„
2. **æŸ”è»Ÿæ€§**: æ®µéšçš„ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ§‹ç¯‰ã§ãã‚‹
3. **è²¬å‹™åˆ†é›¢**: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç”Ÿæˆã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆ†é›¢

```java
// ä¾‹ï¼šæ®µéšçš„ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ§‹ç¯‰
ChangePasswordCommand cmd = new ChangePasswordCommand(); // OK
cmd.setCurrentPassword("current123");                    // OK
cmd.setNewPassword("new456");                           // OK
// ã“ã®æ™‚ç‚¹ã§validator.validate(cmd)ã‚’å®Ÿè¡Œã—ã¦åˆã‚ã¦ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
```

## ğŸ­ Spring Boot ã®é­”æ³•ï¼šJSON â†’ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå¤‰æ›

ã§ã¯ã€å®Ÿéš›ã® Web ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã©ã†ãªã£ã¦ã„ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

### Controller ã§ã® @Valid ã®è¬

```java
@PostMapping("/api/auth/change-password")
public ResponseEntity<?> changePassword(@Valid @RequestBody ChangePasswordCommand command) {
    // â†‘ ã“ã®@ValidãŒé‡è¦
    // ã§ã‚‚ã€commandã£ã¦ã©ã“ã‹ã‚‰æ¥ãŸã®ï¼Ÿï¼Ÿ

    changePasswordService.changePassword(userId, command);
    return ResponseEntity.ok().build();
}
```

**ã€Œcommand ã£ã¦ã©ã“ã«ã‚‚å­˜åœ¨ã—ã¦ãªã‹ã£ãŸã˜ã‚ƒã‚“ï¼ã€**

ã¾ã•ã«ã“ã“ãŒã€Spring Boot ã®**è‡ªå‹•ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³**ã®ä»•çµ„ã¿ã§ã™ã€‚

### å®Ÿéš›ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant Client
    participant Spring
    participant Jackson
    participant Validator
    participant Controller

    Client->>Spring: POST /api/auth/change-password<br/>{"currentPassword": "abc", "newPassword": "xyz"}

    Spring->>Jackson: JSONæ–‡å­—åˆ—ã‚’å—ä¿¡
    Jackson->>Jackson: new ChangePasswordCommand() // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
    Jackson->>Jackson: setCurrentPassword("abc")
    Jackson->>Jackson: setNewPassword("xyz")
    Jackson->>Spring: å®Œæˆã—ãŸCommandã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
    Spring->>Validator: @Valid ã«ã‚ˆã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
    Spring->>Controller: changePassword(command) å‘¼ã³å‡ºã—
```

### Step-by-Step ã§è¦‹ã‚‹å¤‰æ›ãƒ—ãƒ­ã‚»ã‚¹

```java
// 1. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰é€ä¿¡ã•ã‚Œã‚‹JSON
{
  "currentPassword": "CurrentPass123",
  "newPassword": "NewPass456"
}

// 2. Spring Bootå†…éƒ¨ã®å‡¦ç†ï¼ˆJackson ObjectMapperãŒå®Ÿè¡Œï¼‰
ChangePasswordCommand command = new ChangePasswordCommand(); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
command.setCurrentPassword("CurrentPass123");                // JSONã®currentPasswordã‚’ã‚»ãƒƒãƒˆ
command.setNewPassword("NewPass456");                       // JSONã®newPasswordã‚’ã‚»ãƒƒãƒˆ

// 3. @Validã«ã‚ˆã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
Set<ConstraintViolation<ChangePasswordCommand>> violations = validator.validate(command);

// 4. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸæ™‚ã€Controllerãƒ¡ã‚½ãƒƒãƒ‰ã«æ¸¡ã•ã‚Œã‚‹
changePassword(command); // â† ã“ã“ã§commandãŒåˆ©ç”¨å¯èƒ½
```

## ğŸ”§ å¿…è¦ãªä»•çµ„ã¿ï¼šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¨ Setter

Jackson ãŒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹ãŸã‚ã«å¿…è¦ãªã‚‚ã®ãŒã‚ã‚Šã¾ã™ï¼š

```java
public class ChangePasswordCommand {
    // 1. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒå¿…é ˆ
    public ChangePasswordCommand(){}

    // 2. setterãƒ¡ã‚½ãƒƒãƒ‰ãŒå¿…é ˆï¼ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã§ã‚‚OKï¼‰
    void setCurrentPassword(String currentPassword) {
        this.currentPassword = currentPassword;
    }

    void setNewPassword(String newPassword) {
        this.newPassword = newPassword;
    }
}
```

### ãªãœ setter ãŒ`void`ãªã®ã‹ï¼Ÿ

```java
// ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã®setterãƒ¡ã‚½ãƒƒãƒ‰
void setCurrentPassword(String currentPassword) {
    this.currentPassword = currentPassword;
}
```

- **Jackson ã‚¢ã‚¯ã‚»ã‚¹ç”¨**: JSON â†’ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå¤‰æ›æ™‚ã«ä½¿ç”¨
- **å¤–éƒ¨éå…¬é–‹**: ä»–ã®ã‚¯ãƒ©ã‚¹ã‹ã‚‰ã¯ç›´æ¥å‘¼ã³å‡ºã›ãªã„
- **ãƒ†ã‚¹ãƒˆå°‚ç”¨**: ãƒ†ã‚¹ãƒˆæ™‚ã®ã¿åˆ©ç”¨å¯èƒ½

## âš¡ @Valid ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®æœ¬å½“ã®å½¹å‰²

### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°

| ã‚¿ã‚¤ãƒŸãƒ³ã‚°           | å ´æ‰€                                      | å‹•ä½œ                                  |
| -------------------- | ----------------------------------------- | ------------------------------------- |
| **ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–æ™‚** | `new ChangePasswordCommand(null, "çŸ­ã„")` | **ä¾‹å¤–ã¯æŠ•ã’ã‚‰ã‚Œãªã„**                |
| **@Valid å®Ÿè¡Œæ™‚**    | Controller ã® `@Valid @RequestBody`       | `MethodArgumentNotValidException`ç™ºç”Ÿ |
| **æ‰‹å‹•å®Ÿè¡Œæ™‚**       | ãƒ†ã‚¹ãƒˆã® `validator.validate(cmd)`        | `Set<ConstraintViolation>`ãŒè¿”ã•ã‚Œã‚‹  |

### å®Ÿéš›ã®å®Ÿè¡Œé †åº

```java
@PostMapping("/change-password")
public ResponseEntity<?> changePassword(@Valid @RequestBody ChangePasswordCommand command) {
    // ã“ã®æ™‚ç‚¹ã§ command ã¯ï¼š
    // âœ… æ—¢ã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–æ¸ˆã¿
    // âœ… JSONãƒ‡ãƒ¼ã‚¿ãŒã‚»ãƒƒãƒˆæ¸ˆã¿
    // âœ… ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œæ¸ˆã¿ï¼ˆæˆåŠŸã—ãŸã‹ã‚‰åˆ°é”ï¼‰

    // å®‰å¿ƒã—ã¦commandã‚’ä½¿ç”¨å¯èƒ½
    System.out.println(command.getCurrentPassword()); // JSONã®å€¤ãŒå…¥ã£ã¦ã„ã‚‹
}
```

## ğŸ¯ å®Œå…¨ãªå‡¦ç†ãƒ•ãƒ­ãƒ¼ã®ç†è§£

### HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆ â†’ Controller ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œã¾ã§

```mermaid
sequenceDiagram
    participant Client
    participant Spring
    participant Jackson
    participant Validator
    participant Controller

    Client->>Spring: POST /api/auth/change-password<br/>{"currentPassword": "abc", "newPassword": "xyz"}

    Note over Spring: 1. @PostMapping ã«ã‚ˆã‚Šã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç‰¹å®š

    Spring->>Jackson: 2. @RequestBody ã«ã‚ˆã‚Š JSON â†’ Object å¤‰æ›é–‹å§‹
    Jackson->>Jackson: new ChangePasswordCommand()<br/>setCurrentPassword("abc")<br/>setNewPassword("xyz")
    Jackson->>Spring: å®Œæˆã—ãŸcommandã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

    Spring->>Validator: 3. @Valid ã«ã‚ˆã‚Š validator.validate(command) å®Ÿè¡Œ

    alt ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ
        Validator->>Spring: ç©ºã®violationsSet
        Spring->>Controller: 4. changePassword(command) ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—
        Controller->>Controller: ã‚µãƒ¼ãƒ“ã‚¹å±¤å‡¦ç†å®Ÿè¡Œ
    else ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•—
        Validator->>Spring: ConstraintViolationã®é›†åˆ
        Spring->>Client: MethodArgumentNotValidException<br/>â†’ 400 Bad Request
        Note over Controller: ãƒ¡ã‚½ãƒƒãƒ‰ã¯å®Ÿè¡Œã•ã‚Œãªã„
    end
```

### é‡è¦ãª 4 ã¤ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

1. **`@PostMapping`**: HTTP ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆã©ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¶ã‹æ±ºå®šï¼‰
2. **`@RequestBody`**: JSONâ†’ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå¤‰æ›ã®æŒ‡ç¤º
3. **`ChangePasswordCommand command`**: å¤‰æ›å…ˆã®å‹æŒ‡å®š
4. **`@Valid`**: å¤‰æ›å¾Œã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ

## ğŸ” ConstraintViolation ã£ã¦ä½•ï¼Ÿ

### è¤‡æ•°ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é•åã‚’æ‰±ã†

```java
// ä¾‹ï¼šè¤‡æ•°ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é•åãŒç™ºç”Ÿã™ã‚‹ã‚±ãƒ¼ã‚¹
ChangePasswordCommand cmd = new ChangePasswordCommand(null, "çŸ­ã„");

Set<ConstraintViolation<ChangePasswordCommand>> violations = validator.validate(cmd);
// violations.size() = 3 ã®å¯èƒ½æ€§
// 1. currentPassword ãŒ null (@NotNullé•å)
// 2. currentPassword ãŒç©º (@NotBlanké•å)
// 3. newPassword ãŒçŸ­ã™ãã‚‹ (@Sizeé•å)
```

### ConstraintViolation ã®è©³ç´°æƒ…å ±

å„ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é•åã®è©³ç´°æƒ…å ±ã‚’å–å¾—ã§ãã¾ã™ï¼š

```java
for (ConstraintViolation<ChangePasswordCommand> violation : violations) {
    // ã©ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§é•åã—ãŸã‹
    String property = violation.getPropertyPath().toString(); // "currentPassword"

    // é•åã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    String message = violation.getMessage(); // "ç¾åœ¨ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å¿…é ˆã§ã™"

    // é•åã—ãŸå€¤
    Object invalidValue = violation.getInvalidValue(); // null

    // ã©ã®ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§é•åã—ãŸã‹
    Class<? extends Annotation> annotation = violation.getConstraintDescriptor()
        .getAnnotation().annotationType(); // NotNull.class
}
```

## ğŸ› ï¸ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ä»•çµ„ã¿

### GlobalExceptionHandler ã¨ã®é€£æº

```java
@ExceptionHandler({MethodArgumentNotValidException.class, ConstraintViolationException.class})
public ResponseEntity<ErrorResponse> handleValidation(Exception exception, HttpServletRequest request) {
    // @Validã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•—æ™‚ã«ã“ã“ãŒå‘¼ã°ã‚Œã‚‹
    log.warn("Validation error: {} {} - {}", request.getMethod(), request.getRequestURI(),
             exception.getClass().getSimpleName());
    return ResponseEntity.status(HttpStatus.BAD_REQUEST)
        .body(body(request, "å…¥åŠ›å€¤ãŒä¸æ­£ã§ã™ã€‚", ApiErrorCode.VALIDATION_ERROR));
}
```

### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•—æ™‚ã®æµã‚Œ

```java
// ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å¤±æ•— â†’ ä¾‹å¤–ç™ºç”Ÿ â†’ ExceptionHandler â†’ ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´
// Controller ãƒ¡ã‚½ãƒƒãƒ‰ã¯å®Ÿè¡Œã•ã‚Œãªã„
```

## ğŸ’¡ å®Ÿéš›ã®ãƒ†ã‚¹ãƒˆã§ã®å¿œç”¨

### ãƒ†ã‚¹ãƒˆã§ã®ä½¿ç”¨ä¾‹

```java
@Test
@DisplayName("è¤‡æ•°ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é•åã®æ¤œè¨¼")
void multipleValidationErrors_shouldFail() {
    // ã“ã®ã‚³ãƒãƒ³ãƒ‰ã§ã¯è¤‡æ•°ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é•åãŒç™ºç”Ÿ
    ChangePasswordCommand cmd = new ChangePasswordCommand(null, "abc");

    Set<ConstraintViolation<ChangePasswordCommand>> violations = validator.validate(cmd);

    // ç‰¹å®šã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã‚¨ãƒ©ãƒ¼ãŒèµ·ããŸã‹ãƒã‚§ãƒƒã‚¯
    assertThat(violations).anyMatch(v ->
        v.getPropertyPath().toString().equals("currentPassword")
    ); // currentPasswordã§@NotNullé•å

    assertThat(violations).anyMatch(v ->
        v.getPropertyPath().toString().equals("newPassword")
    ); // newPasswordã§@Sizeé•å
}
```

### ã‚«ã‚¹ã‚¿ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚‚åŒã˜ä»•çµ„ã¿

```java
@DifferentPasswords  // ã‚«ã‚¹ã‚¿ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
public class ChangePasswordCommand {
    // æ–°æ—§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒåŒã˜ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯
}
```

## ğŸ‰ ã¾ã¨ã‚ï¼šSpring Boot ã®ç¾ã—ã„è¨­è¨ˆ

ä»Šå›ã®å­¦ã³ã‚’ã¾ã¨ã‚ã‚‹ã¨ï¼š

### Bean Validation ã®åŸºæœ¬åŸå‰‡

1. **ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã§ã¯ä¾‹å¤–ãªã—**: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¯åˆ¥ç‰©
2. **å®£è¨€çš„ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã€å®Ÿè¡Œã¯æ˜ç¤ºçš„ã«
3. **æ®µéšçš„æ§‹ç¯‰**: æŸ”è»Ÿã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’çµ„ã¿ç«‹ã¦å¯èƒ½

### Spring Boot ã®è‡ªå‹•åŒ–ã®ä»•çµ„ã¿

1. **`@PostMapping`** ã§ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç™ºç«
2. **`@RequestBody ChangePasswordCommand`** ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
3. **`@Valid`** ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
4. **æˆåŠŸæ™‚ã®ã¿** Controller ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè¡Œ

### é–‹ç™ºè€…ã«å„ªã—ã„è¨­è¨ˆ

```java
// é–‹ç™ºè€…ãŒæ›¸ãã‚³ãƒ¼ãƒ‰ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰
@PostMapping("/change-password")
public ResponseEntity<?> changePassword(@Valid @RequestBody ChangePasswordCommand command) {
    changePasswordService.changePassword(userId, command);
    return ResponseEntity.ok().build();
}

// Spring BootãŒè£ã§ã‚„ã£ã¦ãã‚Œã‚‹ã“ã¨ï¼ˆè¤‡é›‘ï¼‰
// 1. JSON parsing
// 2. Object instantiation
// 3. Property mapping
// 4. Validation execution
// 5. Error handling
```

ã“ã‚ŒãŒ Spring Boot ã® **ã€Œå®£è¨€çš„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã€** ã®ç¾ã—ã•ã§ã™ã€‚ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ã€Œä½•ã‚’ã—ãŸã„ã‹ã€ã‚’å®£è¨€ã™ã‚‹ã ã‘ã§ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒå…¨éƒ¨ã‚„ã£ã¦ãã‚Œã‚‹ï¼

### æœ€åˆã®ç–‘å•ã«æˆ»ã£ã¦

```java
Set<ConstraintViolation<ChangePasswordCommand>> violations = validator.validate(cmd);
```

ã“ã® 1 è¡Œã®è£ã«ã¯ã€ä»¥ä¸‹ã®æ·±ã„ä»•çµ„ã¿ãŒéš ã•ã‚Œã¦ã„ã¾ã—ãŸï¼š

- Bean Validation ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«
- Spring Boot ã®è‡ªå‹•å¤‰æ›æ©Ÿèƒ½
- Jackson ObjectMapper ã®å‹•ä½œ
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®çµ±åˆ

ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‹ã‚‰å§‹ã¾ã£ãŸå°ã•ãªç–‘å•ãŒã€Spring Boot ã®æ ¸å¿ƒçš„ãªä»•çµ„ã¿ã®ç†è§£ã«ã¤ãªãŒã‚Šã¾ã—ãŸã€‚

**ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚€æ™‚ã¯ã€Œãªãœï¼Ÿã€ã‚’å¤§åˆ‡ã«ã—ã¾ã—ã‚‡ã†ã€‚ãã£ã¨æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚‹ã¯ãšã§ã™ï¼** ğŸš€
